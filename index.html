<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>GhostProxy | Hardened Deep Tunnel</title>

<script src="https://js.puter.com/v2/"></script>

<style>

body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', system-ui, sans-serif; background: #050505; color: #00ff41; overflow: hidden; }

#nav { height: 60px; background: #111; display: flex; align-items: center; padding: 0 20px; gap: 15px; border-bottom: 2px solid #00ff41; box-shadow: 0 4px 20px rgba(0,255,65,0.1); z-index: 100; position: relative; }

.brand { font-weight: bold; font-family: monospace; color: #00ff41; text-shadow: 0 0 5px #00ff41; }

input { flex: 1; padding: 12px; border-radius: 4px; border: 1px solid #333; background: #000; color: #00ff41; font-family: 'Consolas', monospace; outline: none; transition: border 0.3s; }

input:focus { border-color: #00ff41; }

button { padding: 10px 20px; cursor: pointer; background: #00ff41; color: #000; border: none; border-radius: 4px; font-weight: bold; text-transform: uppercase; }

button:hover { background: #00cc33; }

#status { font-size: 11px; color: #008f11; font-family: monospace; min-width: 140px; text-align: right; }


#viewer-container {

width: 100%;

height: calc(100% - 62px);

background: #fff;

position: relative;

overflow: auto;

color: initial;

}

</style>

</head>

<body>



<div id="nav">

<span class="brand">GHOST_PROXY v3.1</span>

<input type="text" id="url-input" value="https://www.croxyproxy.com" placeholder="Enter target URL...">

<button onclick="launch()">Execute</button>

<div id="status">INIT_READY</div>

</div>



<div id="viewer-container">

<div id="placeholder" style="padding: 20px; color: #666;">Enter a URL and press Execute to start the tunnel.</div>

</div>



<script>

const viewer = document.getElementById('viewer-container');

const urlInput = document.getElementById('url-input');

const statusBox = document.getElementById('status');

let sessionCookies = "";



window.onbeforeunload = function() {

return "GhostProxy prevented an external redirect.";

};



async function launch() {

request(urlInput.value);

}



async function request(targetUrl, method = 'GET', body = null) {

statusBox.innerText = "ESTABLISHING_TUNNEL...";


try {

const options = {

method: method,

headers: {

'Cookie': sessionCookies,

'Referer': 'https://www.croxyproxy.com/'

}

};

if (body) {

options.body = body;

options.headers['Content-Type'] = 'application/x-www-form-urlencoded';

}



const response = await puter.net.fetch(targetUrl, options);


const newCookies = response.headers.get('set-cookie');

if (newCookies) sessionCookies = newCookies;



let html = await response.text();


render(html, targetUrl);

statusBox.innerText = "TUNNEL_STABLE";

} catch (err) {

statusBox.innerText = "CONNECTION_LOST";

console.error("Tunnel Error:", err);

viewer.innerHTML = `<div style="color:red; padding:20px;">Error: ${err.message}</div>`;

}

}



function render(html, baseUrl) {

// Clear initial placeholder if it exists

const placeholder = document.getElementById('placeholder');

if (placeholder) placeholder.remove();



// Check if shadow root already exists to avoid the NotSupportedError

let shadow = viewer.shadowRoot;

if (!shadow) {

shadow = viewer.attachShadow({mode: 'open'});

}



// Clear the existing content inside the shadow root

shadow.innerHTML = '';



const contentWrapper = document.createElement('div');


// Strip out common redirect triggers

let sanitizedHtml = html

.replace(/window\.top/gi, 'window.self')

.replace(/top\.location/gi, 'window.self.location')

.replace(/parent\.location/gi, 'window.self.location')

.replace(/<meta[^>]*refresh[^>]*>/gi, '');



contentWrapper.innerHTML = `

<base href="${baseUrl}">

${sanitizedHtml}

`;



// Hijack links

contentWrapper.querySelectorAll('a').forEach(link => {

link.addEventListener('click', e => {

const href = link.getAttribute('href');

if (href && !href.startsWith('javascript:') && !href.startsWith('#')) {

e.preventDefault();

const destination = new URL(href, baseUrl).href;

urlInput.value = destination;

request(destination);

}

});

});



// Hijack forms

contentWrapper.querySelectorAll('form').forEach(form => {

form.addEventListener('submit', e => {

e.preventDefault();

const fd = new FormData(form);

const data = new URLSearchParams(fd).toString();

const action = new URL(form.getAttribute('action') || '', baseUrl).href;

urlInput.value = action;

request(action, 'POST', data);

});

});



shadow.appendChild(contentWrapper);

}



window.onload = () => { if(urlInput.value) launch(); };

</script>



</body>

</html>
